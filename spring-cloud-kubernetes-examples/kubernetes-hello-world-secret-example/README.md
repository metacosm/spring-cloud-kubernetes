# Hello World Example

This Spring Boot application exposes an endpoint that we can call to receive a `Hello` message as response. The 
received message is customized using a [Kubernetes secret](https://kubernetes.io/docs/concepts/configuration/secret) 
that provides a `greeting.secretName` value that the application uses to create the message response. The application
is configured using the `@RestController` annotation and the method returning the message is annotated with 
`@RequestMapping("/")`.

The Spring Boot uberjar application is packaged within a Docker image using the 
[Fabric8 Maven plugin](maven.fabric8.io) and next deployed top of the Kubernetes management platform as a pod 
using the replication controller created by the plugin.

To play with the example, it is required to have access to a Kubernetes Management Platform. You can install locally 
Kubernetes & Docker using [Minikube](https://kubernetes.io/docs/getting-started-guides/minikube/).
  
When the client is installed on your machine, you can start kubernetes using this command:
```
minikube start
```

You will need to create a secret named 
`hello-world-secret` first with a single `greeting.secretName` entry. You can create your own using the procedure 
above or use the provided one:
```bash
kubectl create -f ./example-secret.yml
``` 

Next, you can play with this Spring Boot application in the cloud using the following maven command to deploy it:
```
mvn clean package fabric8:deploy -Pkubernetes
```  
   
When the application has been deployed, you can access its service or endpoint URL using this command:
```   
minikube service kubernetes-hello-world --url
```
  
And next you can curl the endpoint using the url returned by the previous command

``` 
curl http://IP_OR_HOSTNAME/
```
     
## Integration test

To deploy the resources required on Kubernetes/OpenShift and to test if the service deployed can answer to requests, 
we will use the 
[Arquillian Kubernetes Cube](https://github.com/arquillian/arquillian-cube/blob/master/docs/kubernetes.adoc) framework. 
This testing framework uses the Kubernetes Java API to communicate with the platform, deploy the resources (pod, 
service, deployment, â€¦) generated by the Fabric8 maven plugin. When the service becomes available, the method defined
 within the Junit test will call the endpoint to verify that it receives as response the string
`Hello World`

Remark : If you run the integration test against OpenShift, create first the namespace/project `it` that arquillian 
will use to deploy the resources using the oc client `oc new-project it` and log in to it (`oc login`).

When you are logged to the OpenShift platform, execute the following maven command to run the Integration Test against OpenShift   

``` 
mvn clean install -Pintegration
```
